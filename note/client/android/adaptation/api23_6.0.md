### 动态权限

传感器,日历,摄像头,通讯录,地理位置,麦克风,电话,短信,存储空间.
#### 检查权限是否Grant

if(checkSelfPermission(Manifest.permission.RECORD_AUDIO)
               != PackageManager.PERMISSION_GRANTED){
       mNumPermissionsToRequest++;
       mShouldRequestSoundPermission = true;
   }

#### 申请权限
if(mShouldRequestStoragePermission){
       permissionToRequest[permissionRequestIndex] =   Manifest.permission.WRITE_EXTERNAL_STORAGE;
       mIndexPermissionRequestStorage= permissionRequestIndex;
       permissionRequestIndex++;
   }
    //关键是这句,调用这个API之后会出现如下的对话框，这个对话框是系统UI，不需要APP来写
   if(permissionToRequest.length > 0){
       requestPermissions(permissionToRequest, PERMISSION_REQUEST_CODE);
   }

#### 回调处理

@Override
public void onRequestPermissionsResult(int requestCode,
      String permissions[], int[] grantResults) {
       switch (requestCode) {
       case PERMISSION_REQUEST_CODE:
           if (grantResults.length > 0
                   && grantResults[0] == PackageManager.PERMISSION_GRANTED) {
               Log.v(TAG, "Grant permission successfully");
           } else {
               Log.v(TAG, "Grant permission unsuccessfully");
           }
           break;
       default:
           break;
   }
}

### 第三方库

PermissionChecker:
mPermissionChecker = new PermissionChecker();
mPermissionChecker.setActivity(this)
                       .setDefaultDialog(true)
                       .setPermissions(new String[]{Manifest.permission.WRITE_EXTERNAL_STORAGE})
                       .setCallback(new PermissionCheckCallback() {
                           @Override
                           public void onRequest() {
                           }

                           @Override
                           public void onGranted() {
                               initView();
                           }

                           @Override
                           public void onGrantSuccess() {
                               initView();
                           }

                           @Override
                           public void onGrantFail() {
                           }
                       }).checkPermission();

//回调的时候调用PermissionChecker的onRequestPermissionsResult方法

@Override
public void onRequestPermissionsResult(int requestCode,
        String permissions[], int[] grantResults) {
       mPermissionChecker.onRequestPermissionsResult(requestCode, permissions, grantResults);
}



